<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Topographic correction — topo_corr • SatRbedo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Topographic correction — topo_corr"><meta name="description" content="This tool corrects surface reflectance for the effects of topography. The objective
of the topographic correction is to compensate for the differences in solar
illumination to minimize the variability of observed reflectance for similar
targets and obtain the equivalent reflectance values over flat terrain. The empirical
methods provided here are suitable for mountain environments with rugged topography
and non-Lambertian surface properties. More details about these methods can be found
in the references below."><meta property="og:description" content="This tool corrects surface reflectance for the effects of topography. The objective
of the topographic correction is to compensate for the differences in solar
illumination to minimize the variability of observed reflectance for similar
targets and obtain the equivalent reflectance values over flat terrain. The empirical
methods provided here are suitable for mountain environments with rugged topography
and non-Lambertian surface properties. More details about these methods can be found
in the references below."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SatRbedo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pabl1t0x/SatRbedo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Topographic correction</h1>
      <small class="dont-index">Source: <a href="https://github.com/pabl1t0x/SatRbedo/blob/master/R/topo_corr.R" class="external-link"><code>R/topo_corr.R</code></a></small>
      <div class="d-none name"><code>topo_corr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This tool corrects surface reflectance for the effects of topography. The objective
of the topographic correction is to compensate for the differences in solar
illumination to minimize the variability of observed reflectance for similar
targets and obtain the equivalent reflectance values over flat terrain. The empirical
methods provided here are suitable for mountain environments with rugged topography
and non-Lambertian surface properties. More details about these methods can be found
in the references below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">topo_corr</span><span class="op">(</span><span class="va">band</span>, <span class="va">dem</span>, <span class="va">SAA</span>, <span class="va">SZA</span>, method <span class="op">=</span> <span class="st">"tanrotation"</span>, IC_min <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-band">band<a class="anchor" aria-label="anchor" href="#arg-band"></a></dt>
<dd><p>SpatRaster. Spectral band to be corrected.</p></dd>


<dt id="arg-dem">dem<a class="anchor" aria-label="anchor" href="#arg-dem"></a></dt>
<dd><p>SpatRaster. Digital elevation model representing terrain elevation
on a regular grid.</p></dd>


<dt id="arg-saa">SAA<a class="anchor" aria-label="anchor" href="#arg-saa"></a></dt>
<dd><p>SpatRaster or numeric. Solar azimuth angle in degrees.</p></dd>


<dt id="arg-sza">SZA<a class="anchor" aria-label="anchor" href="#arg-sza"></a></dt>
<dd><p>SpatRaster or numeric. Solar zenith angle in degrees.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character. Topographic correction model to be used. Two options are
available: "tanrotation" (implements the rotation model proposed by Tan et al. 2010)
,
and "ccorrection" (C model, Teillet et al. 1982)
.</p></dd>


<dt id="arg-ic-min">IC_min<a class="anchor" aria-label="anchor" href="#arg-ic-min"></a></dt>
<dd><p>numeric. Minimum incidence angle to mask out regions of low illumination.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list with two objets. The first component is a SpatRaster with two layers
providing the illumination condition (IC) and the corrected surface reflectance, and the
second component contains the values of the empirical parameters obtained by each topographic
correction model.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chen R, Yin G, Zhao W, Yan K, Wu S, Hao D, Liu G (2023).
“Topographic Correction of Optical Remote Sensing Images in Mountainous Areas: A systematic review.”
<em>IEEE Geoscience and Remote Sensing Magazine</em>, <b>11</b>(4), 125–145.
<a href="https://doi.org/10.1109/MGRS.2023.3311100" class="external-link">doi:10.1109/MGRS.2023.3311100</a>
.<br><br> Riaño D, Chuvieco E, Salas J, Aguado I (2003).
“Assessment of different topographic corrections in Landsat-TM data for mapping vegetation types.”
<em>IEEE Transactions on Geoscience and Remote Sensing</em>, <b>41</b>(5), 1056–1061.
<a href="https://doi.org/10.1109/TGRS.2003.811693" class="external-link">doi:10.1109/TGRS.2003.811693</a>
.<br><br> Tan B, Masek JG, Wolfe R, Gao F, Huang C, Vermote EF, Sexton JO, Ederer G (2013).
“Improved forest change detection with terrain illumination corrected Landsat images.”
<em>Remote Sensing of Environment</em>, <b>136</b>, 469–483.
<a href="https://doi.org/10.1016/j.rse.2013.05.013" class="external-link">doi:10.1016/j.rse.2013.05.013</a>
.<br><br> Tan B, Wolfe R, Masek J, Gao F, Vermote EF (2010).
“An illumination correction algorithm on Landsat-TM data.”
In <em>2010 IEEE International Geoscience and Remote Sensing Symposium</em>, 1964-1967.
<a href="https://doi.org/10.1109/IGARSS.2010.5653492" class="external-link">doi:10.1109/IGARSS.2010.5653492</a>
.<br><br> Teillet PM, Guindon B, Goodenough DG (1982).
“On the Slope-Aspect Correction of Multispectral Scanner Data.”
<em>Canadian Journal of Remote Sensing</em>, <b>8</b>(2), 84–106.
<a href="https://doi.org/10.1080/07038992.1982.10855028" class="external-link">doi:10.1080/07038992.1982.10855028</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="preproc.html">preproc()</a></code>, <code>landsat::topocorr()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/athabasca_outline.shp"</span>, package <span class="op">=</span> <span class="st">"SatRbedo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/athabasca_B8A_20200911.tif"</span>, package <span class="op">=</span> <span class="st">"SatRbedo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/athabasca_dem.tif"</span>, package <span class="op">=</span> <span class="st">"SatRbedo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nir</span> <span class="op">&lt;-</span> <span class="fu"><a href="preproc.html">preproc</a></span><span class="op">(</span>grd <span class="op">=</span> <span class="va">nir</span>, outline <span class="op">=</span> <span class="va">outline</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="preproc.html">preproc</a></span><span class="op">(</span>grd <span class="op">=</span> <span class="va">dem</span>, outline <span class="op">=</span> <span class="va">outline</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SAA</span> <span class="op">&lt;-</span> <span class="fl">164.8</span></span></span>
<span class="r-in"><span><span class="va">SZA</span> <span class="op">&lt;-</span> <span class="fl">48.9</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Topographic correction using method="tanrotation"</span></span></span>
<span class="r-in"><span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu">topo_corr</span><span class="op">(</span>band <span class="op">=</span> <span class="va">nir</span>, dem <span class="op">=</span> <span class="va">dem</span>, SAA <span class="op">=</span> <span class="va">SAA</span>, SZA <span class="op">=</span> <span class="va">SZA</span>, method <span class="op">=</span> <span class="st">"tanrotation"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">corr</span><span class="op">$</span><span class="va">bands</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># plot IC</span></span></span>
<span class="r-plt img"><img src="topo_corr-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">corr</span><span class="op">$</span><span class="va">bands</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># plot corrected surface reflectance</span></span></span>
<span class="r-plt img"><img src="topo_corr-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Topographic correction using method="ccorrection"</span></span></span>
<span class="r-in"><span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu">topo_corr</span><span class="op">(</span>band <span class="op">=</span> <span class="va">nir</span>, dem <span class="op">=</span> <span class="va">dem</span>, SAA <span class="op">=</span> <span class="va">SAA</span>, SZA <span class="op">=</span> <span class="va">SZA</span>, method <span class="op">=</span> <span class="st">"ccorrection"</span>, IC_min <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">corr</span><span class="op">$</span><span class="va">bands</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># plot corrected surface reflectance</span></span></span>
<span class="r-plt img"><img src="topo_corr-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pablo Fuchs.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

