<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Anisotropy correction of reflected radiation over melting snow and glacier ice — f_BRDF • SatRbedo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Anisotropy correction of reflected radiation over melting snow and glacier ice — f_BRDF"><meta name="description" content="This tool corrects for the anisotropy of reflected radiation by melting snow and ice.
For a given surface type, the correction is carried out using an empirical model
of the Bidirectional Reflectance Distribution Function (BRDF) that depends on
the wavelength bands and the view-solar geometry. The procedure is applicable to visible,
near-infrared (NIR), and shortwave-infrared (SWIR) wavelenghts. More details about
the parameterizations can be found in the references list."><meta property="og:description" content="This tool corrects for the anisotropy of reflected radiation by melting snow and ice.
For a given surface type, the correction is carried out using an empirical model
of the Bidirectional Reflectance Distribution Function (BRDF) that depends on
the wavelength bands and the view-solar geometry. The procedure is applicable to visible,
near-infrared (NIR), and shortwave-infrared (SWIR) wavelenghts. More details about
the parameterizations can be found in the references list."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SatRbedo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pabl1t0x/SatRbedo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Anisotropy correction of reflected radiation over melting snow and glacier ice</h1>
      <small class="dont-index">Source: <a href="https://github.com/pabl1t0x/SatRbedo/blob/master/R/albedo_sat.R" class="external-link"><code>R/albedo_sat.R</code></a></small>
      <div class="d-none name"><code>f_BRDF.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This tool corrects for the anisotropy of reflected radiation by melting snow and ice.
For a given surface type, the correction is carried out using an empirical model
of the Bidirectional Reflectance Distribution Function (BRDF) that depends on
the wavelength bands and the view-solar geometry. The procedure is applicable to visible,
near-infrared (NIR), and shortwave-infrared (SWIR) wavelenghts. More details about
the parameterizations can be found in the references list.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">f_BRDF</span><span class="op">(</span><span class="va">SAA</span>, <span class="va">SZA</span>, <span class="va">VAA</span>, <span class="va">VZA</span>, <span class="va">slope</span>, <span class="va">aspect</span>, <span class="va">method</span>, <span class="va">green</span>, <span class="va">NIR</span>, <span class="va">th</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-saa">SAA<a class="anchor" aria-label="anchor" href="#arg-saa"></a></dt>
<dd><p>SpatRaster or numeric. Solar azimuth angle in degrees.</p></dd>


<dt id="arg-sza">SZA<a class="anchor" aria-label="anchor" href="#arg-sza"></a></dt>
<dd><p>SpatRaster or numeric. Solar zenith angle in degrees.</p></dd>


<dt id="arg-vaa">VAA<a class="anchor" aria-label="anchor" href="#arg-vaa"></a></dt>
<dd><p>SpatRaster or numeric. Satellite sensor azimuth angle in degrees.</p></dd>


<dt id="arg-vza">VZA<a class="anchor" aria-label="anchor" href="#arg-vza"></a></dt>
<dd><p>SpatRaster or numeric. Satellite sensor zenith angle in degrees.</p></dd>


<dt id="arg-slope">slope<a class="anchor" aria-label="anchor" href="#arg-slope"></a></dt>
<dd><p>SpatRaster or numeric. Surface slope in degrees.</p></dd>


<dt id="arg-aspect">aspect<a class="anchor" aria-label="anchor" href="#arg-aspect"></a></dt>
<dd><p>SpatRaster or numeric. Surface aspect in degrees.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character. Number of spectral bands considered for the anisotropy
correction. There are two options available: "twobands" (green and NIR) using
the parameterizations of Greuell and De Ruyter De Wildt (1999)
 for ice
and Koks (2001)
 for snow, and "fivebands"
(blue, red, NIR, SWIR1, and SWIR2) using the methods described in
Ren et al. (2021)
.</p></dd>


<dt id="arg-green">green<a class="anchor" aria-label="anchor" href="#arg-green"></a></dt>
<dd><p>SpatRaster. Green band surface reflectance (0.53-0.59 um).</p></dd>


<dt id="arg-nir">NIR<a class="anchor" aria-label="anchor" href="#arg-nir"></a></dt>
<dd><p>SpatRaster. Near-infrared band surface reflectance (0.85-0.88 um).</p></dd>


<dt id="arg-th">th<a class="anchor" aria-label="anchor" href="#arg-th"></a></dt>
<dd><p>numeric. NDSII threshold to discriminate between snow and ice.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a SpatRaster with two layers for <code>method="twobands"</code> and five layers
for <code>method="fivebands"</code>. Each layer contains the anisotropic reflection factors (<code>f</code>)
for each spectral band and surface type (snow or ice). All <code>f</code> values represent the
difference between the satellite albedo retrievals and the surface reflectance observations.</p>
    </div>
    <div class="section level2">
    <h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a></h2>


<p><code>f</code> is not calculated for <code>method="twobands"</code> if the green or the NIR surface
reflectance values are greater than one or for pixels for which the SZA relative to the inclined
surface is &gt;65.51° over snow or &gt;74.2° over ice. For <code>method="fivebands"</code>, <code>f</code> is not
calculated if the SZA relative to the inclined surface is &gt;70.9° over snow or &gt;57.6°
over ice.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>De Ruyter De Wildt MS, Oerlemans J, Björnsson H (2002).
“A method for monitoring glacier mass balance using satellite albedo measurements: application to Vatnajökull, Iceland.”
<em>Journal of Glaciology</em>, <b>48</b>(161), 267–278.
<a href="https://doi.org/10.3189/172756502781831458" class="external-link">doi:10.3189/172756502781831458</a>
.<br><br> Greuell W, De Ruyter De Wildt M (1999).
“Anisotropic reflection by melting glacier ice: measurements and parametrizations in Landsat TM Bands 2 and 4.”
<em>Remote Sensing of Environment</em>, <b>70</b>(3), 265–277.
<a href="https://doi.org/10.1016/S0034-4257%2899%2900043-7" class="external-link">doi:10.1016/S0034-4257(99)00043-7</a>
.<br><br> Koks M (2001).
<em>Anisotropic reflection of radiation by melting snow. Landsat TM bands 2 and 4</em>.
Master's thesis, Universiteit Utrecht. Instituut voor Marien en Atmosferisch Onderzoek Utrecht (IMAU).<br><br> Ren S, Miles ES, Jia L, Menenti M, Kneib M, Buri P, McCarthy MJ, Shaw TE, Yang W, Pellicciotti F (2021).
“Anisotropy parameterization development and evaluation for glacier surface albedo retrieval from satellite observations.”
<em>Remote Sensing</em>, <b>13</b>(9), 1714.
<a href="https://doi.org/10.3390/rs13091714" class="external-link">doi:10.3390/rs13091714</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="preproc.html">preproc()</a></code>, <code><a href="https://rspatial.github.io/terra/reference/terrain.html" class="external-link">terra::terrain()</a></code>, <code><a href="snow_or_ice.html">snow_or_ice()</a></code>, <code><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">terra::plot()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/athabasca_outline.shp"</span>, package <span class="op">=</span> <span class="st">"SatRbedo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">green</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/athabasca_B03_20200911.tif"</span>, package <span class="op">=</span> <span class="st">"SatRbedo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/athabasca_B8A_20200911.tif"</span>, package <span class="op">=</span> <span class="st">"SatRbedo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/athabasca_dem.tif"</span>, package <span class="op">=</span> <span class="st">"SatRbedo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">green</span> <span class="op">&lt;-</span> <span class="fu"><a href="preproc.html">preproc</a></span><span class="op">(</span>grd <span class="op">=</span> <span class="va">green</span>, outline <span class="op">=</span> <span class="va">outline</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nir</span> <span class="op">&lt;-</span> <span class="fu"><a href="preproc.html">preproc</a></span><span class="op">(</span>grd <span class="op">=</span> <span class="va">nir</span>, outline <span class="op">=</span> <span class="va">outline</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="preproc.html">preproc</a></span><span class="op">(</span>grd <span class="op">=</span> <span class="va">dem</span>, outline <span class="op">=</span> <span class="va">outline</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SAA</span> <span class="op">&lt;-</span> <span class="fl">164.8</span></span></span>
<span class="r-in"><span><span class="va">SZA</span> <span class="op">&lt;-</span> <span class="fl">48.9</span></span></span>
<span class="r-in"><span><span class="va">VAA</span> <span class="op">&lt;-</span> <span class="fl">90.9</span></span></span>
<span class="r-in"><span><span class="va">VZA</span> <span class="op">&lt;-</span> <span class="fl">5.2</span></span></span>
<span class="r-in"><span><span class="va">slope</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/terrain.html" class="external-link">terrain</a></span><span class="op">(</span><span class="va">dem</span>, v <span class="op">=</span> <span class="st">"slope"</span>, neighbors <span class="op">=</span> <span class="fl">4</span>, unit <span class="op">=</span> <span class="st">"degrees"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aspect</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/terrain.html" class="external-link">terrain</a></span><span class="op">(</span><span class="va">dem</span>, v <span class="op">=</span> <span class="st">"aspect"</span>, neighbors <span class="op">=</span> <span class="fl">4</span>, unit <span class="op">=</span> <span class="st">"degrees"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># f coefficients for two bands</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">&lt;-</span> <span class="fu"><a href="snow_or_ice.html">snow_or_ice</a></span><span class="op">(</span><span class="va">green</span>, <span class="va">nir</span><span class="op">)</span><span class="op">$</span><span class="va">th</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">f_BRDF</span><span class="op">(</span></span></span>
<span class="r-in"><span>  SAA <span class="op">=</span> <span class="va">SAA</span>, SZA <span class="op">=</span> <span class="va">SZA</span>, VAA <span class="op">=</span> <span class="va">VAA</span>, VZA <span class="op">=</span> <span class="va">VZA</span>,</span></span>
<span class="r-in"><span>  slope <span class="op">=</span> <span class="va">slope</span>, aspect <span class="op">=</span> <span class="va">aspect</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"twobands"</span>, green <span class="op">=</span> <span class="va">green</span>, NIR <span class="op">=</span> <span class="va">nir</span>,</span></span>
<span class="r-in"><span>  th <span class="op">=</span> <span class="va">th</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_BRDF-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_BRDF-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># f coefficients for five bands</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">&lt;-</span> <span class="fu"><a href="snow_or_ice.html">snow_or_ice</a></span><span class="op">(</span><span class="va">green</span>, <span class="va">nir</span><span class="op">)</span><span class="op">$</span><span class="va">th</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">f_BRDF</span><span class="op">(</span></span></span>
<span class="r-in"><span>  SAA <span class="op">=</span> <span class="va">SAA</span>, SZA <span class="op">=</span> <span class="va">SZA</span>, VAA <span class="op">=</span> <span class="va">VAA</span>, VZA <span class="op">=</span> <span class="va">VZA</span>,</span></span>
<span class="r-in"><span>  slope <span class="op">=</span> <span class="va">slope</span>, aspect <span class="op">=</span> <span class="va">aspect</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"fivebands"</span>, green <span class="op">=</span> <span class="va">green</span>, NIR <span class="op">=</span> <span class="va">nir</span>,</span></span>
<span class="r-in"><span>  th <span class="op">=</span> <span class="va">th</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_BRDF-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_BRDF-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_BRDF-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_BRDF-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_BRDF-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pablo Fuchs.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

